<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ã‚²ãƒ¼ãƒ ç¿»è¨³ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: #fff;
      margin: 0;
      padding: 20px;
      overflow-x: hidden;
    }
    h1 {
      font-size: 24px;
      margin: 0 0 20px 0;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    .section {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .section h2 {
      font-size: 18px;
      margin: 0 0 12px 0;
      color: #4CAF50;
    }
    button {
      background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      width: 100%;
      margin-bottom: 10px;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    button:active {
      transform: translateY(0);
    }
    button.primary {
      background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
      font-size: 16px;
      padding: 15px 20px;
    }
    button.danger {
      background: linear-gradient(135deg, #f44336 0%, #da190b 100%);
      width: auto;
      padding: 6px 12px;
      font-size: 12px;
      margin: 0;
    }
    .region-list {
      max-height: 250px;
      overflow-y: auto;
    }
    .region-list::-webkit-scrollbar {
      width: 8px;
    }
    .region-list::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.1);
      border-radius: 4px;
    }
    .region-list::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.3);
      border-radius: 4px;
    }
    .region-item {
      background: rgba(255, 255, 255, 0.15);
      padding: 12px;
      margin-bottom: 8px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .region-info {
      flex: 1;
      font-size: 13px;
    }
    .shortcut {
      background: rgba(0, 0, 0, 0.3);
      padding: 6px 12px;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      display: inline-block;
      margin: 5px 0;
      font-size: 13px;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .status {
      font-weight: bold;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-size: 16px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    .status.active {
      background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
      animation: pulse 2s infinite;
    }
    .status.inactive {
      background: rgba(255, 255, 255, 0.2);
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    input[type="number"] {
      width: 80px;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.1);
      color: white;
      font-size: 14px;
    }
    .input-group {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-bottom: 10px;
    }
    .input-group label {
      flex: 1;
    }
    p {
      margin: 8px 0;
      line-height: 1.6;
    }
    .empty-state {
      text-align: center;
      padding: 30px;
      color: rgba(255,255,255,0.5);
      font-style: italic;
    }
    .tab-container {
      display: flex;
      gap: 5px;
      margin-bottom: 15px;
    }
    .tab {
      flex: 1;
      padding: 10px;
      background: rgba(255,255,255,0.1);
      border: none;
      border-radius: 8px 8px 0 0;
      color: rgba(255,255,255,0.6);
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      transition: all 0.3s;
    }
    .tab.active {
      background: rgba(255,255,255,0.2);
      color: white;
      border-bottom: 3px solid #4CAF50;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
  </style>
</head>
<body>
  <h1>ğŸ® ã‚²ãƒ¼ãƒ ç¿»è¨³ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤</h1>

  <div class="section">
    <h2>ğŸ“Š çŠ¶æ…‹</h2>
    <div id="status" class="status inactive">åœæ­¢ä¸­</div>
  </div>

  <div class="section">
    <h2>âš™ï¸ æ“ä½œ</h2>
    <button class="primary" onclick="startRegionSelection()">ğŸ–±ï¸ ãƒã‚¦ã‚¹ã§é ˜åŸŸã‚’é¸æŠ</button>
    <p><span class="shortcut">Ctrl+Shift+R</span> ã§ã‚‚é¸æŠé–‹å§‹</p>
    
    <button onclick="toggleCapture()">é–‹å§‹ / åœæ­¢</button>
    <p><span class="shortcut">Ctrl+Shift+S</span> ã§ã‚‚åˆ‡æ›¿å¯èƒ½</p>
  </div>

  <div class="section">
    <h2>ğŸ“ é ˜åŸŸè¨­å®š</h2>
    
    <div class="tab-container">
      <button class="tab active" onclick="switchTab(0)">ãƒã‚¦ã‚¹é¸æŠ</button>
      <button class="tab" onclick="switchTab(1)">æ‰‹å‹•å…¥åŠ›</button>
    </div>

    <div class="tab-content active">
      <p style="text-align: center; padding: 20px;">
        ä¸Šã®ã€Œãƒã‚¦ã‚¹ã§é ˜åŸŸã‚’é¸æŠã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€<br>
        ç”»é¢ä¸Šã§ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦é ˜åŸŸã‚’é¸æŠã—ã¦ãã ã•ã„
      </p>
    </div>

    <div class="tab-content">
      <div class="input-group">
        <label>Xåº§æ¨™:</label>
        <input type="number" id="region-x" value="100" min="0">
      </div>
      <div class="input-group">
        <label>Yåº§æ¨™:</label>
        <input type="number" id="region-y" value="100" min="0">
      </div>
      <div class="input-group">
        <label>å¹…:</label>
        <input type="number" id="region-width" value="300" min="50">
      </div>
      <div class="input-group">
        <label>é«˜ã•:</label>
        <input type="number" id="region-height" value="100" min="50">
      </div>
      <button onclick="addRegion()">é ˜åŸŸã‚’è¿½åŠ </button>
      <p style="font-size: 12px; color: rgba(255,255,255,0.7);">
        â€»åº§æ¨™ã¯ã‚¹ã‚¯ãƒªãƒ¼ãƒ³å·¦ä¸Šã‚’(0,0)ã¨ã—ã¾ã™
      </p>
    </div>
  </div>

  <div class="section">
    <h2>ğŸ“‹ ç™»éŒ²æ¸ˆã¿é ˜åŸŸ (<span id="region-count">0</span>)</h2>
    <div id="regions" class="region-list">
      <div class="empty-state">é ˜åŸŸãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</div>
    </div>
  </div>

  <div class="section">
    <h2>â„¹ï¸ ä½¿ã„æ–¹</h2>
    <p>1. LM Studioã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•</p>
    <p>2. ã€Œãƒã‚¦ã‚¹ã§é ˜åŸŸã‚’é¸æŠã€ã‚’ã‚¯ãƒªãƒƒã‚¯</p>
    <p>3. ç”»é¢ä¸Šã§ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ç¯„å›²ã‚’é¸æŠ</p>
    <p>4. ã€Œé–‹å§‹/åœæ­¢ã€ã§ç¿»è¨³ã‚’é–‹å§‹</p>
    <p style="font-size: 12px; color: rgba(255,255,255,0.7); margin-top: 10px;">
      â€»æ›´æ–°é–“éš”: 200msï¼ˆ0.2ç§’ï¼‰
    </p>
  </div>

  <script>
    const { ipcRenderer } = require('electron');
    let isCapturing = false;
    let regions = [];

    function switchTab(index) {
      const tabs = document.querySelectorAll('.tab');
      const contents = document.querySelectorAll('.tab-content');
      
      tabs.forEach((tab, i) => {
        if (i === index) {
          tab.classList.add('active');
          contents[i].classList.add('active');
        } else {
          tab.classList.remove('active');
          contents[i].classList.remove('active');
        }
      });
    }

    function startRegionSelection() {
      ipcRenderer.send('start-region-selection');
    }

    function addRegion() {
      const x = parseInt(document.getElementById('region-x').value);
      const y = parseInt(document.getElementById('region-y').value);
      const width = parseInt(document.getElementById('region-width').value);
      const height = parseInt(document.getElementById('region-height').value);

      if (isNaN(x) || isNaN(y) || isNaN(width) || isNaN(height)) {
        alert('æ­£ã—ã„æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
        return;
      }

      if (width < 50 || height < 50) {
        alert('å¹…ã¨é«˜ã•ã¯50ãƒ”ã‚¯ã‚»ãƒ«ä»¥ä¸Šã«ã—ã¦ãã ã•ã„');
        return;
      }

      ipcRenderer.send('add-region', { x, y, width, height });
    }

    function toggleCapture() {
      ipcRenderer.send('toggle-capture');
    }

    function removeRegion(id) {
      if (confirm('ã“ã®é ˜åŸŸã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
        ipcRenderer.send('remove-region', id);
      }
    }

    ipcRenderer.on('capture-status', (event, active) => {
      isCapturing = active;
      updateStatus();
    });

    ipcRenderer.on('regions-updated', (event, newRegions) => {
      regions = newRegions;
      renderRegions();
    });

    function updateStatus() {
      const statusEl = document.getElementById('status');
      if (isCapturing) {
        statusEl.textContent = 'âœ… å®Ÿè¡Œä¸­ - 0.2ç§’ã”ã¨ã«ç¿»è¨³';
        statusEl.className = 'status active';
      } else {
        statusEl.textContent = 'â¸ï¸ åœæ­¢ä¸­';
        statusEl.className = 'status inactive';
      }
    }

    function renderRegions() {
      const container = document.getElementById('regions');
      const countEl = document.getElementById('region-count');
      
      countEl.textContent = regions.length;

      if (regions.length === 0) {
        container.innerHTML = '<div class="empty-state">é ˜åŸŸãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</div>';
        return;
      }

      container.innerHTML = regions.map((r, i) => `
        <div class="region-item">
          <div class="region-info">
            <strong>é ˜åŸŸ ${i + 1}</strong><br>
            ä½ç½®: (${r.x}, ${r.y}) | ã‚µã‚¤ã‚º: ${r.width}Ã—${r.height}px
          </div>
          <button class="danger" onclick="removeRegion(${r.id})">å‰Šé™¤</button>
        </div>
      `).join('');
    }

    // åˆæœŸçŠ¶æ…‹ã‚’æ›´æ–°
    updateStatus();
  </script>
</body>
</html>